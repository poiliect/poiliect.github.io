<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="css/cs.css">
    <link rel="stylesheet" href="css/cs_book.css">
    <link rel="stylesheet" href="css/input_user.css">
    <link rel="stylesheet" href="css/data_flow.css">
    <!-- ç§»åŠ¨ç«¯ä¸“ç”¨æ ·å¼ -->
    <style>
        /* ç§»åŠ¨ç«¯åŸºç¡€æ ·å¼ */
        * {
            box-sizing: border-box;
            touch-action: manipulation;
        }
        
        body {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: none;
            transition: 0.5s;
        }
        
        /* å›ºå®šå·¦ä¸Šè§’çš„ä¸»é¢˜åˆ‡æ¢æŒ‰é’® */
        .theme-toggle-fixed {
            position: fixed;
            top: 2px;
            left: 2px;
            z-index: 9999;
            opacity: 1 !important;
            visibility: visible !important;
            display: block !important;
        }
        
        .theme-toggle-fixed input[type="checkbox"] {
            display: none;
        }
        
        .theme-switch-fixed {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.3); /* ç™½è‰²åŠé€æ˜ */
            backdrop-filter: blur(10px);
            border-radius: 25px;
            color: #333;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.5);
        }
        
        .theme-switch-fixed i {
            font-style: normal;
            font-size: 18px;
        }
        
        /* å¤œé—´æ¨¡å¼æ ·å¼ */
        body.night-mode .mobile-header,
        body.night-mode .mobile-main,
        body.night-mode .mobile-footer,
        body.night-mode #bg-video_w,
        body.night-mode #particleContainer {
            opacity: 0 !important;
            visibility: hidden !important;
            pointer-events: none !important;
        }
        
        /* ç¡®ä¿ä¸»é¢˜æŒ‰é’®åœ¨å¤œé—´æ¨¡å¼ä¸‹ä»ç„¶å¯è§ */
        body.night-mode .theme-toggle-fixed {
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* ç§»åŠ¨ç«¯å¤´éƒ¨ */
        .mobile-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: opacity 0.5s;
        }
        
        .mobile-title h1 {
            margin: 0;
            font-size: 1.2rem;
            color: #333;
        }
        
        .mobile-time {
            font-size: 0.9rem;
            color: #333;
            font-weight: 600;
        }
        
        /* ä¸»å†…å®¹åŒº */
        .mobile-main {
            margin-top: 60px;
            height: calc(100vh - 180px);
            padding: 15px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            opacity: 1;
            transition: opacity 0.5s;
        }
        
        /* è¾“å…¥åŒºåŸŸ */
        .input-container {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .mobile-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px);
            color: #333;
        }
        
        .mobile-input:focus {
            border-color: rgba(102, 126, 234, 0.7);
        }
        
        .mobile-input::placeholder {
            color: rgba(51, 51, 51, 0.7);
        }
        
        .send-btn {
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            color: #333;
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .send-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.4);
        }
        
        /* è§„åˆ™åŒºåŸŸ */
        .rules-container {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .rules-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                rgba(124, 231, 156, 0.7), 
                rgba(224, 231, 124, 0.7), 
                rgba(231, 167, 124, 0.7), 
                rgba(231, 124, 124, 0.7),
                rgba(231, 124, 195, 0.7), 
                rgba(179, 124, 231, 0.7), 
                rgba(131, 124, 231, 0.7), 
                rgba(124, 206, 231, 0.7),
                rgba(124, 224, 231, 0.7), 
                rgba(124, 231, 195, 0.7), 
                rgba(124, 231, 156, 0.7));
            background-size: 1000% 100%;
            animation: gradientFlow 3s linear infinite;
        }
        
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        
        .rules-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .rules-header h2 {
            margin: 0;
            font-size: 1.3rem;
            color: #333;
        }
        
        .rules-time {
            font-size: 1rem;
            color: #667eea;
            font-weight: 600;
        }
        
        .rules-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .rules-list li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            color: #333;
            position: relative;
            padding-left: 25px;
        }
        
        .rules-list li:last-child {
            border-bottom: none;
        }
        
        .rules-list li::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: #667eea;
            font-size: 1.2rem;
        }
        
        /* åº•éƒ¨æ“ä½œæ  */
        .mobile-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 120px;
            background: rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            transition: opacity 0.5s;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        .control-btn {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .control-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.4);
        }
        
        .control-btn i {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .control-btn span {
            font-size: 12px;
            font-weight: 600;
            color: #333;
        }
        
        /* ç²’å­å®¹å™¨ */
        #particleContainer {
            position: fixed;
            top: -20px;
            left: 0;
            right: 0;
            bottom: 120px;
            pointer-events: none;
            z-index: -1;
            transition: opacity 0.5s;
        }
        
        /* è§†é¢‘å®¹å™¨ */
        #bg-video_w {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
            opacity: 1;
            transition: opacity 0.5s;
        }
        
        /* åå¸æç¤º */
        .toast {
            position: fixed;
            bottom: 140px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 14px;
            z-index: 2000;
            opacity: 0;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 480px) {
            .mobile-header {
                height: 50px;
                padding: 0 10px;
            }
            
            .mobile-main {
                margin-top: 50px;
                height: calc(100vh - 160px);
                padding: 10px;
            }
            
            .mobile-footer {
                height: 110px;
                padding: 10px;
            }
            
            .control-btn span {
                font-size: 10px;
            }
            
            .theme-switch-fixed {
                padding: 6px 12px;
                font-size: 12px;
            }
        }
    </style>
    <link rel="icon" href="image_CKG/c2.png" type="png">
<title>AAAå»ºæç‹æ€» - ç§»åŠ¨ç«¯</title>
</head>

<body id="body">

<!-- å›ºå®šåœ¨å·¦ä¸Šè§’çš„ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
<div class="theme-toggle-fixed">
    <label>
        <input type="checkbox" id="themeToggle">
        <div class="theme-switch-fixed">
            <i id="themeIcon">ğŸŸ¡</i>
            <span id="themeLabel">æ—¥é—´æ¨¡å¼</span>
        </div>
    </label>
</div>
<!-- ä¸»å†…å®¹ -->
<main class="mobile-main">
    <!-- è¾“å…¥æ¡† -->
    <div class="input-container">
        <input type="text" class="mobile-input" placeholder="è¾“å…¥å†…å®¹..." id="mobileInput">
        <button class="send-btn" id="sendBtn">å‘é€</button>
    </div>
    
    <!-- è§„åˆ™åˆ—è¡¨ -->
    <div class="rules-container">
        <div class="rules-header">
            <h2>ğŸ“š å…¥ç«™è§„åˆ™</h2>
            <div class="rules-time" id="clockTime"></div>
        </div>
        <ul class="rules-list">
            <li>æœ€ç»ˆè§£é‡Šæƒå½’æœ¬ç«™æ‰€æœ‰</li>
            <li>ç”¨æˆ·åº”éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„</li>
            <li>ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨æœ¬ç«™çš„é£é™©</li>
            <li>ä¸å¯æŠ—åŠ›å¯¼è‡´æœåŠ¡ä¸­æ–­ä¸æ‰¿æ‹…è´£ä»»</li>
            <li>å•†ä¸šè½¬è½½éœ€è·å¾—ä¹¦é¢æˆæƒ</li>
            <li>ç”¨æˆ·å‘å¸ƒå†…å®¹ä¸ä»£è¡¨æœ¬ç«™ç«‹åœº</li>
            <li>æœ¬ç«™ä¿ç•™éšæ—¶ä¿®æ”¹å†…å®¹çš„æƒåˆ©</li>
            <li>ä¸æ‰¿æ‹…ç›´æ¥æˆ–é—´æ¥æŸå¤±è´£ä»»</li>
            <li>æœ¬ç«™ä»…ä¾›äº¤æµå­¦ä¹ </li>
            <li>ä½¿ç”¨æœ¬ç«™å³è¡¨ç¤ºæ¥å—æœ¬å£°æ˜</li>
        </ul>
    </div>
    
    <!-- ç²’å­å®¹å™¨ -->
    <div id="particleContainer" class="particle-container"></div>
    
    <!-- è§†é¢‘èƒŒæ™¯ -->
    <div class="video-background_w">
        <video autoplay muted loop id="bg-video_w">
            <source src="image_CKG/Wavy Grass 4K60FPS.mp4" type="video/mp4">
        </video>
    </div>
</main>

<!-- åº•éƒ¨æ“ä½œæ  -->
<footer class="mobile-footer">
    <div class="controls">
        <button class="control-btn" id="clearBtn">
            <i>ğŸ—‘ï¸</i>
            <span>æ¸…ç©º</span>
        </button>
        <!-- ç§»é™¤äº†"æˆ‘çˆ±ä½ "æŒ‰é’® -->
        <button class="control-btn" id="resetBtn">
            <i>ğŸ”„</i>
            <span>é‡ç½®</span>
        </button>
    </div>
</footer>

<!-- æ˜Ÿç©ºç”»å¸ƒ -->
<canvas id="space" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -3;"></canvas>


<script src="js/data_flow.js"></script>
<script src="js/input_user.js"></script>
<script src="js/js_clock.js"></script>
<script src="js/js.js"></script>

<script>
// ç§»åŠ¨ç«¯åˆå§‹åŒ–è„šæœ¬
document.addEventListener('DOMContentLoaded', function() {
    console.log('ç§»åŠ¨ç«¯é¡µé¢å·²åŠ è½½');
    
    // åˆå§‹åŒ–ç²’å­ç³»ç»Ÿ
    window.particleSystem = new ParticleSystem();
    
    // è·å–å…ƒç´ 
    const mobileInput = document.getElementById('mobileInput');
    const sendBtn = document.getElementById('sendBtn');
    const clearBtn = document.getElementById('clearBtn');
    const resetBtn = document.getElementById('resetBtn');
    const themeToggle = document.getElementById('themeToggle');
    const themeLabel = document.getElementById('themeLabel');
    const video = document.getElementById('bg-video_w');
    const body = document.getElementById('body');
    const themeIcon = document.getElementById('themeIcon');
    
    // å‘é€åŠŸèƒ½
    sendBtn.addEventListener('click', function() {
        const text = mobileInput.value.trim();
        if (text) {
            particleSystem.addUserInput(text);
            mobileInput.value = '';
            showToast('å·²å‘é€: ' + text);
            mobileInput.focus();
        }
    });
    
    // å›è½¦å‘é€
    mobileInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendBtn.click();
        }
    });
    
    // æ¸…ç©ºæŒ‰é’®
    clearBtn.addEventListener('click', function() {
        particleSystem.clearUserInputs();
        showToast('å·²æ¸…ç©ºè¾“å…¥é˜Ÿåˆ—');
    });
    
    // æˆ‘çˆ±ä½ æŒ‰é’®
    // é‡ç½®æŒ‰é’®
    resetBtn.addEventListener('click', function() {
        particleSystem.addUserInput("|");
        showToast('å·²é‡ç½®ç²’å­æ•ˆæœ');
    });
    
    // ä¸»é¢˜åˆ‡æ¢
    themeToggle.addEventListener('change', function() {
        if (this.checked) {
            // å¤œé—´æ¨¡å¼
            body.classList.add('night-mode');
            body.style.backgroundColor = '#000';
            if (video) video.style.opacity = '0';
            themeIcon.textContent = "âš«";
            themeLabel.textContent = 'å¤œé—´æ¨¡å¼';
            themeLabel.style.color = "white";
            showToast('å·²åˆ‡æ¢è‡³å¤œé—´æ¨¡å¼');

            
            // å¯åŠ¨æ˜Ÿç©ºåŠ¨ç”»
            if (typeof window.kaishi === 'function' && !window.animationRunning) {
                window.kaishi();
            }
        } else {
            // æ—¥é—´æ¨¡å¼
            body.classList.remove('night-mode');
            body.style.backgroundColor = '';
            if (video) video.style.opacity = '1';
            themeIcon.textContent = "ğŸŸ¡";
            themeLabel.textContent = 'æ—¥é—´æ¨¡å¼';
            themeLabel.style.color = "black";
            showToast('å·²åˆ‡æ¢è‡³æ—¥é—´æ¨¡å¼');
            
            // åœæ­¢æ˜Ÿç©ºåŠ¨ç”»
            if (typeof window.kaishi === 'function' && window.animationRunning) {
                window.kaishi();
            }
        }
    });
    
    // æ—¶é—´æ˜¾ç¤º
    function updateTime() {
        const now = new Date();
        const timeStr = now.toLocaleTimeString('zh-CN', {
            hour12: false,
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
        });
        
        const mobileTime = document.getElementById('mobileTime');
        const clockTime = document.getElementById('clockTime');
        
        if (mobileTime) mobileTime.textContent = timeStr;
        if (clockTime) clockTime.textContent = timeStr;
    }
    
    updateTime();
    setInterval(updateTime, 1000);
    
    // åå¸æç¤º
    function showToast(message) {
        // ç§»é™¤ç°æœ‰åå¸
        const oldToast = document.querySelector('.toast');
        if (oldToast) oldToast.remove();
        
        // åˆ›å»ºæ–°åå¸
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.textContent = message;
        document.body.appendChild(toast);
        
        // æ˜¾ç¤º
        setTimeout(() => toast.classList.add('show'), 10);
        
        // 3ç§’åéšè—
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => {
                if (toast.parentNode) toast.remove();
            }, 300);
        }, 2000);
    }
    
    // è§¦æ‘¸åé¦ˆ
    const buttons = document.querySelectorAll('button');
    buttons.forEach(btn => {
        btn.addEventListener('touchstart', function() {
            this.style.opacity = '0.7';
        });
        
        btn.addEventListener('touchend', function() {
            this.style.opacity = '';
        });
    });
    
    // åˆå§‹åŒ–æ˜Ÿç©ºç”»å¸ƒ
    function initMobileSpace() {
        const canvas = document.getElementById('space');
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const stars = [];
        const starCount = Math.min(200, Math.floor(window.innerWidth * window.innerHeight / 1000));
        
        for (let i = 0; i < starCount; i++) {
            stars.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 1.5 + 0.5,
                speed: Math.random() * 0.5 + 0.2,
                opacity: Math.random() * 0.5 + 0.3
            });
        }
        
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            stars.forEach(star => {
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;
                ctx.fill();
                
                star.y += star.speed;
                
                if (star.y > canvas.height) {
                    star.y = 0;
                    star.x = Math.random() * canvas.width;
                }
            });
            
            if (!window.animationRunning) {
                requestAnimationFrame(animate);
            }
        }
        
        if (!window.animationRunning) {
            animate();
        }
    }
    
    // åˆå§‹åŒ–æ˜Ÿç©º
    initMobileSpace();
    
    // çª—å£å¤§å°å˜åŒ–æ—¶é‡ç½®
    window.addEventListener('resize', function() {
        const canvas = document.getElementById('space');
        if (canvas) {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
    });
});
</script>

</body>
</html>